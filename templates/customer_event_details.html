{% extends 'nav.html' %}

{% block title %} Event Detail {% endblock %}

{% block content %}
<style>
    /* Main container */
    .event-container {
        display: flex;
        flex-wrap: wrap;
        max-width: 850px;
        margin: 2rem auto;
        background: transparent;
        gap: 1.5rem;
        padding: 1rem;
    }

    /* Image side */
    .event-image {
        flex: 1 1 45%;
        background: #000;
        border-radius: 12px;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0.8rem;
    }

    .event-image img {
        width: 100%;
        height: auto;
        object-fit: cover;
        border-radius: 8px;
    }

    /* Details side */
    .event-details {
        flex: 1 1 55%;
        background: #1e1e1e;
        border-radius: 12px;
        padding: 1.5rem;
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.3);
    }

    .event-title {
        font-size: 1.6rem;
        font-weight: bold;
        margin-bottom: 0.4rem;
    }

    .event-category {
        background: #ff5722;
        display: inline-block;
        padding: 0.3rem 0.7rem;
        border-radius: 50px;
        font-size: 0.8rem;
        margin-bottom: 1rem;
    }

    .event-meta {
        display: flex;
        flex-direction: column;
        gap: 0.6rem;
        font-size: 0.95rem;
        margin-bottom: 1rem;
    }

    .event-meta div {
        display: flex;
        align-items: center;
        gap: 0.4rem;
    }

    .event-meta i {
        color: #ffc107;
    }

    .description-title {
        font-weight: bold;
        color: #ffc107;
        margin-bottom: 0.4rem;
        font-size: 1rem;
    }

    /* Button container */
    .button-group {
        display: flex;
        flex-direction: column;
        gap: 0.6rem;
        /* spacing between the two buttons */
        margin-top: 1.5rem;
        /* space above Book button */
    }

    .book-btn,
    .back-btn {
        width: 100%;
        /* full width */
        text-align: center;
        padding: 0.8rem;
        border-radius: 6px;
        font-weight: bold;
        font-size: 1rem;
        text-decoration: none;
        display: block;
    }

    .book-btn {
        background: #ffc107;
        color: black;
        transition: 0.3s;
    }

    .book-btn:hover {
        background: #ff9800;
        color: white;
    }

    .back-btn {
        background: #333;
        color: white;
        font-size: 0.95rem;
    }

    .back-btn:hover {
        background: #555;
        color: #ffc107;
    }

    /* Mobile responsive */
    @media (max-width: 900px) {
        .event-container {
            flex-direction: column;
            max-width: 95%;
        }

        .event-image,
        .event-details {
            flex: 1 1 100%;
        }
    }
</style>
{% if messages %}
<div class="container mt-3">
    {% for message in messages %}
        <div class="alert 
            {% if message.tags == 'success' %}alert-success
            {% elif message.tags == 'info' %}alert-info
            {% elif message.tags == 'warning' %}alert-warning
            {% elif message.tags == 'error' %}alert-danger
            {% else %}alert-secondary{% endif %} 
            alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endfor %}
</div>
{% endif %}


<div class="event-container">
    <!-- Left: Event Image -->
    <div class="event-image">
        <img src="{{ event.banner.url }}" alt="{{ event.title }}">
    </div>

    <!-- Right: Event Details -->
    <div class="event-details">
        <div>
            <div class="event-title">{{ event.title }}</div>
            <span class="event-category">{{ event.category }}</span>

            <div class="event-meta">
                <div><i class="bi bi-calendar-event"></i> {{ event.date|date:"F j, Y" }}</div>
                <div><i class="bi bi-geo-alt"></i> {{ event.location }}</div>
                <div>
                    <i class="bi bi-clock"></i>
                    {{ event.time|time:"h:i A" }} - {{ event.end_time|time:"h:i A" }}
                    {% if event.duration %}
                    <small class="text-warning">({{ event.duration }})</small>
                    {% endif %}
                </div>
                <div><i class="bi bi-person"></i> Organizer: {{ event.organizer }}</div>
                <div><i class="bi bi-telephone"></i> Contact: {{ event.organizer.phone }}</div>

                <div><i class="fa fa-inr"></i> {% if event.price == 0 %}
                    Free
                    {% else %}
                    {{ event.price }}
                    {% endif %}</div>
            </div>

            <!-- Show Available & Booked Seats -->
            <div class="event-meta">
                <div><i class="bi bi-people-fill"></i> Capacity: {{ event.capacity }}</div>
                <div><i class="bi bi-check-circle-fill text-success"></i> Booked: {{ event.total_registrations }}</div>
                <div><i class="bi bi-hourglass-bottom text-warning"></i> Available: {{ event.available_seats }}</div>
            </div>

            <div><i class="bi bi-hourglass-split"></i>
                Registration Deadline: {{ event.registration_deadline}}
            </div>
        </div>

        <br>

        <div class="description-title">Description</div>
        <p>{{ event.description|linebreaks }}</p>



        <!-- Terms & Conditions -->
        {% if event.terms_and_conditions %}
        <div class="description-title">Terms & Conditions</div>
        <p>{{ event.terms_and_conditions}}</p>
        {% endif %}

        <!-- Button group centered & spaced -->
        <div class="button-group">
            {% if event.registration_deadline and event.registration_deadline < today %} <a class="back-btn"
                style="background:#b71c1c; cursor:not-allowed; opacity:0.8;">
                ‚õî Registration Closed
                </a>
                {% else %}
                <a href="{% url 'book_event' event.id %}" class="book-btn">üéü Book Now</a>
                {% if user.is_authenticated %}
                <a href="{% url 'save_event' event.id %}" class="btn btn-warning">‚≠ê Save Event</a>
                {% endif %}
                {% endif %}


                <a href="{% url 'all_events' %}" class="back-btn">‚Üê Back to All Events</a>
        </div>
    </div>
</div>
</div>

{% endblock %}